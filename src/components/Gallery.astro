---
import { Image, Picture } from "@astrojs/image/components";
const { images, id } = Astro.props;
---

<script>
	import { initializeGalleries } from "../lib/gallery";
	document.addEventListener("DOMContentLoaded", () => initializeGalleries({}));
</script>

{
	images.length > 1 ? (
		<div data-gallery={id} class="flex flex-col gap-4">
			<div class="splide slider__main">
				<div class="splide__track">
					<ul class="splide__list rounded-md overflow-hidden">
						{images.map((image, index) => (
							<a
								data-fslightbox={`${id}`}
								href={image.url}
								class="splide__slide"
							>
								<Picture
									loading={index === 0 ? 'eager' : 'lazy' }
									id={`image-${id}_${index}`}
									widths={[320, 640, 720]}
									sizes="(max-width: 800px) 100vw, 800px"
									src={image.path}
									class:list={["bg-gray-100", "block"]}
									alt={image.alt ?? ''}
								/>
							</a>
						))}
					</ul>
				</div>
			</div>

			<div class="splide slider__thumbnails">
				<div class="splide__track">
					<ul class="splide__list">
						{images.map((image) => (
							<li class="splide__slide rounded-md overflow-hidden bg-gray-100">
								<Image
									class="object-cover h-full"
									sizes="(max-width: 800px) 100vw, 800px"
									src={image.path}
									class:list={["bg-gray-100", "block"]}
									alt={image.alt ?? ''}
								/>
							</li>
						))}
					</ul>
				</div>
			</div>
		</div>
	) : (
		<div class="rounded-md overflow-hidden bg-gray-100">
			{images.map((image, index) => (
				<Picture
					loading={'eager'}
					id={`image-${id}_${index}`}
					widths={[320, 640, 720]}
					sizes="(max-width: 800px) 100vw, 800px"
					src={image.path}
					class:list={["bg-gray-100", "block"]}
					alt={image.alt ?? ''}
				/>
			))}
		</div>
	)
}
